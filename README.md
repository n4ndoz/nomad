# nomad
## Introduction
This is the repository for the "Not entirely a Molecular Dynamics" protocol, a.k.a NoMaD. Here are some important parts of my masters project, and I hope it will help you in some way. Bellow I will describe briefly the theory behind NoMaD, but be advised that **this repository is under construction**, and most probably everything will change heavily while I'm still into active development on this project. All the files needed to run everything will be made available in due time ~because it takes time to organize everything and my PC is a mess~. As of now **most of the code will be made available inside upyter Notebooks**, some of them may become libraries in near future. <br>
<br>
## What is NoMaD about?
Thinking about the dynamics of a protein structure we can rapidly conclude that it is a huge system to wrapp up mathematically. You've got several atoms, each of them of a different type, arranged on a somewhat energetically stable conformation at each **timestep** through time. Obviously, right? Protein is moving, and so are it's atoms. On a simulation the Potential Energy over each atom can be used to calculate a force vector, and thereby calculate where the protein will be in the next **timestep**, or it's conformation $R_\t$ at timestep $\tau = t$. If we observe every possible conformation of the protein during a given **time interval**, we can stabilish a probability for each of these conformations with respect to (wrt) it's energy values. Nothing new here, this is basically what Mr Boltzmann discovered and this is why we have a distribution on his name. Why this is important? Because ~almost~everything on the dynamics of a protein is distributed wrt it's potential energy. With a few adaptations we can boil down some calculations and assume that the Free Energy of a system evolves in time wrt it's conformations. The problem is that normally MD simulations are carried over small timesteps, and since it is an iterative process, "walking over " **all possible conformations** is prohibitive, since those modifications demand microseconds of simulation time. Which normally translates to months of CPU time. This poses several problems, since not all labs have comp  resources to afford these. <br>
Some scientists proposed alternatives that take into account the fact that an MD Simulation is, fundamentally, a sampling procedure. Since Free Energy translates to probability ~Hello Uncle Boltzmann!!~, when we use a Potential Energy function we are basically using a Probability Density Function (lot's of assumptions here, ok?), that describes the probability of every conformation, considering all possible conformations given it's corresponding PE. If we have a PDF, we can input data and it evaluates, anyhow, the probability of observing this input and, by using some math tricks, one may be able sample from this distribution. This is why we can approach MD as a probabilistic problem, and this opens up a plethora of new methods to implement. <br>
If we imagine the Free Energy Landscape, or the plot of G by conformation, as a highway. Going from the first possible conformation to the last one to be observed. every conformation along this road have an address, the Free Energy. So in this way, with whatever value of G, one could theoretically describe every conformation possible. Wrapping up stuff; we may remember that MD runs wrt time (one step at a time) while the conformational space **is not** distributed wrt time, but wrt Free or Potential Energy. MD --> Conformation x Time (we calculate PE for each conformer to guess where the atoms maybe on the next step, deriving force and velocity), PEL --> G/PE x Conformation (it is just a distribution of all possible conformations by it's energy, a conditional distribution?). <br>
Back to the highway; so, in every point of the higway (conformation) we have an "address" (value of G/PE). And, because of this "structure" we could theoretically use any **possible** value of G/PE to find any conformation and **vice-versa**. In MD, what we do is starting at a somewhat good point (nearby the native state), and we use Newton's Laws of Mechanic to get PE from each conformation, calculate the forces over each atom and move them to a new conformation. The problem here is that this initial "walking" on the road doesn't cover much of the entire highway, unless you simulate for SEVERAL seconds. All this is linked to the nature of protein movements... certain movements are harder for the structure to perform, and thereby take long to happen (high amplitude). Recall that the longer the MD, the longer your PC will need to work on the calculations. Well, then what to do? <br>
We use physics!!! We know that energy generally go up when temperature goes up as well. Lot's of methods make use of this fact. This and lot's of other constraints, like "no two atoms can occupy the same space at once", or restraints on the angles, forcing the structure not to explode or, in other words, reach **impossible** conformations. Taking the example of Replica Exchange; several small MDs are run under different temperatures. At some time, those replicas stop, they exchange their velocities (to where and how much the atom realocates from previous position to thenext) and resume running, each one at it's original temperature. The idea here is that, with several random velocities exchanges we could sample more regions of the conformational space at once, and with a smaller cost. Let's get back to the road and analyze what RE does. <br>
Recall that, in our highway, one can go back and forth and localize itsefl using an Energy value (G or PE). We know that temperature affects the free energy of a given system. What if we wanted to map this highway, finding out where every possible and interesting conformations are. Where does RE comes into this? Well, imagine that, in order to make this map, they get several cars (the replicas) and spread them to random points along our highway. Then all those cars will drive, at different speeds and direction (back or forth), for some time while they draw the path they made. At some point, we retrieve all cars and exchange their locations. Each car, holding it's ending directions and speed, will now explore a different region of the road. Well, each car, in the end is a group of conformations, that will explore different regions of the PEL. And all this noise, theoretically helps bringing the protein to different plausible but unobserved conformation.<br>
Quick recap: we have a protein moving in time. We call the set of all **possible** conformations wrt to PE, the Protein Energy landscape, or, our dear highway to Conformationland. And, we know that, to mapp this road it takes long, and some shortcuts were made possible using a bit of noise and a huge deal of temperature. And, ok, we have alternate ways to map the highway and get unacessible (less probable) conformations. But the problem is that no algorithm can effitiently map this highway and interpolate those points, in other words driving from one point to another on the highway, since the highway is not just a straight line and it may also contain curvas. Many many programs are good at finding out those regions, but demand extra MD simulations to "fine tune" the discovered conformation, or to further explore this conformation. What we propose with NoMaD is a way to enhance those methods. In other words we are proposing some kind of protocol to "link the points" found by the alternate sampling methods, like RE etc. Without performing aditional MDs and using Deep Learning. <br><br>
## Ok. But what is NoMaD?
(explicar aqui o HERMS e a lógica de interpolação) <br>
## How is this Git organized
We have 3 main folders: <br>
* 1- **main**: <br>
Everything related to the future library will be here, all the scripts (when out of jupyter notebooks) will be here. <br>
* 2- **utils**:<br>
Well, i will throw lot's of helper scripts here, stuff used by other scripts and modules. <br>
* 3- **proto**: <br>
All the notebooks will be here, named accordingly to the task.
